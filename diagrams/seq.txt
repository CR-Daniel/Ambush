@startuml
skinparam backgroundColor #EEEBDC
skinparam sequenceArrowThickness 2
skinparam sequenceLifeLineBorderColor #565A5C
skinparam sequenceParticipantBorderColor #565A5C
skinparam sequenceParticipantBackgroundColor #F3F3F3
skinparam sequenceMessageAlignment left
skinparam defaultFontName Courier

title Game Flow Sequence Diagram

actor GameManager
participant SkyboxLoader
participant Blackout
participant MusicManager
participant CometSpawner
participant ScoreBoard
participant SpaceshipSpawner

GameManager -> GameManager: Start Game\nSet State: LoadSkybox

== LoadSkybox ==

GameManager -> SkyboxLoader: Notify: Game State Changed
SkyboxLoader -> SkyboxLoader: Load Random Skybox
SkyboxLoader -> GameManager: Set State: Start

== Start ==

GameManager -> Blackout: Notify: Game State Changed
GameManager -> MusicManager: Notify: Game State Changed
Blackout -> Blackout: Fade In View
MusicManager -> MusicManager: Fade In Music

== ==

CometSpawner -> CometSpawner: Listen for CometHitRacket Event
CometSpawner -> GameManager: Set State: Play (On First Comet Hit)

== Play ==

GameManager -> CometSpawner: Notify: Game State Changed
GameManager -> ScoreBoard: Notify: Game State Changed
GameManager -> SpaceshipSpawner: Notify: Game State Changed
CometSpawner -> CometSpawner: Spawn Comets Regularly
ScoreBoard -> ScoreBoard: Start Timer
SpaceshipSpawner -> SpaceshipSpawner: Spawn Spaceships Regularly

== ==

ScoreBoard -> GameManager: Set State: End (Timer Run Out)

== End ==

GameManager -> Blackout: Notify: Game State Changed
GameManager -> MusicManager: Notify: Game State Changed
Blackout -> Blackout: Fade Out View and Reload Level
MusicManager -> MusicManager: Fade Out Music
@enduml
